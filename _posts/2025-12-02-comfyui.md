
# ComfyUI

ComfyUI æ˜¯ä¸€æ¬¾ **åŸºæ–¼ç¯€é»ï¼ˆNode-basedï¼‰æµç¨‹çš„ Stable Diffusion ä»‹é¢**ï¼Œè®“ä½¿ç”¨è€…èƒ½ä»¥ã€Œæ‹–æ‹‰ç¯€é»ã€çš„æ–¹å¼ï¼Œç›´è¦ºåœ°å»ºç«‹ã€èª¿æ•´èˆ‡ç®¡ç†æ•´å€‹ AI å½±åƒç”Ÿæˆæµç¨‹ã€‚

---

## ğŸ§© ComfyUI æ˜¯ä»€éº¼ï¼Ÿ

**ComfyUI æ˜¯ä¸€å¥—é«˜åº¦æ¨¡çµ„åŒ–ã€å¯è¦–åŒ–çš„ Stable Diffusion å·¥ä½œæµç¨‹å·¥å…·ã€‚**
èˆ‡ä¸€èˆ¬çš„åœ–åƒç”Ÿæˆä»‹é¢ï¼ˆå¦‚ Automatic1111ï¼‰ä¸åŒï¼Œå®ƒè®“ä½ èƒ½çœ‹è¦‹æ•´å€‹ç”Ÿæˆç®¡ç·šçš„ç´°ç¯€ï¼ŒåŒ…æ‹¬ï¼š

* æ¨¡å‹å¦‚ä½•è¼‰å…¥
* Prompt å¦‚ä½•å‚³é
* æ§åˆ¶ç¶²ï¼ˆControlNetï¼‰æ€éº¼é€£æ¥
* LoRAã€VAEã€Upscaler ç­‰æ¨¡çµ„æ€éº¼çµ„åˆ
* æœ€å¾Œå¦‚ä½•è¼¸å‡ºåœ–ç‰‡

æ‰€æœ‰æµç¨‹éƒ½ä»¥ã€Œç¯€é»ï¼ˆNodesï¼‰ã€å‘ˆç¾ï¼Œä½¿ç”¨è€…å¯ä»¥è‡ªç”±æ‹–æ›³ã€é€£æ¥ä¸¦çµ„åˆä¸åŒåŠŸèƒ½çš„ç¯€é»ï¼Œå½¢æˆè‡ªå·±çš„å·¥ä½œæµï¼ˆworkflowï¼‰ã€‚

---

## ğŸ§  ComfyUI çš„å„ªé»

### âœ” éå¸¸éˆæ´»ã€å¯è¦–åŒ–

å¯ä»¥çœ‹è¦‹æ¯ä¸€æ­¥çš„è¼¸å…¥èˆ‡è¼¸å‡ºï¼Œæ¯”é»‘ç›’å­å¼çš„ä»‹é¢æ›´æ˜“ç†è§£ã€‚

### âœ” å°é€²éšä½¿ç”¨è€…æ¥µå‹å–„

è¨­è¨ˆè¤‡é›œæµç¨‹æ›´å®¹æ˜“ï¼Œä¾‹å¦‚ï¼š

* å¤šéšæ®µç”Ÿæˆ
* å¤šæ¨¡å‹èåˆ
* è‡ªå‹•åŒ–æ‰¹æ¬¡è™•ç†
* å‹•æ…‹æ§åˆ¶åƒæ•¸
* é€²éš ControlNet èˆ‡ LoRA å †ç–Š

### âœ” é«˜æ•ˆèƒ½

ComfyUI çš„è¨ˆç®—æµç¨‹ååˆ†ç²¾ç°¡ï¼Œè³‡æºæ•ˆç‡é«˜æ–¼è¨±å¤šåŒé¡å·¥å…·ã€‚

### âœ” å¯æ“´å……æ€§å¼·

æ”¯æ´è¨±å¤šç¬¬ä¸‰æ–¹ç¯€é»èˆ‡å¤–æ›ï¼ˆComfyUI-Manager å¯ä¸€éµå®‰è£ï¼‰ã€‚

### âœ” å¯é‡ç¾æ€§ä½³ï¼ˆReproducible Workflowsï¼‰

---
## ComfyUI å®‰è£æ–¹å¼


## æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Comfy CLI å®‰è£ï¼ˆæ¨è–¦ï¼‰

Comfy CLI æ˜¯ ComfyUI å®˜æ–¹æä¾›çš„å‘½ä»¤åˆ—å·¥å…·ï¼Œå¯ä»¥å¤§å¹…ç°¡åŒ–å®‰è£èˆ‡ç®¡ç†æµç¨‹ã€‚([ComfyUI Wiki][2])

### æ­¥é©Ÿ

#### 1. ç³»çµ±ç’°å¢ƒæº–å‚™

* **ç¢ºèª Python ç’°å¢ƒ**
  ComfyUI éœ€è¦ Python 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚

  ```bash
  python3 --version
  ```

  è‹¥ç³»çµ±ä¸­å°šæœªå®‰è£æˆ–ç‰ˆæœ¬éèˆŠï¼Œå¯ä¾ç…§ä½ çš„ Linux ç™¼è¡Œç‰ˆåŸ·è¡Œå®‰è£ï¼š

  * Ubuntu / Debianï¼š

    ```bash
    sudo apt update
    sudo apt install python3 python3-pip python3-venv
    ```
  * CentOS / RHELï¼š

    ```bash
    sudo yum install python3 python3-pip
    ```
  * Fedoraï¼š

    ```bash
    sudo dnf install python3 python3-pip
    ```
  * Arch Linuxï¼š

    ````bash
    sudo pacman -S python python-pip
    ``` :contentReference[oaicite:5]{index=5}

    ````
* **å®‰è£ Git**ï¼ˆå¦‚æœå°šæœªå®‰è£ï¼‰

  ````bash
  # Ubuntu / Debian
  sudo apt install git

  # CentOS / RHEL
  sudo yum install git

  # Fedora
  sudo dnf install git

  # Arch Linux
  sudo pacman -S git
  ``` :contentReference[oaicite:6]{index=6}

  ````
* **å»ºç«‹è™›æ“¬ç’°å¢ƒï¼ˆæ¨è–¦ï¼‰**
  ä½¿ç”¨è™›æ“¬ç’°å¢ƒæœ‰åŠ©æ–¼é¿å… Python å¥—ä»¶è¡çªã€‚

  ```bash
  python3 -m venv comfy-env
  source comfy-env/bin/activate
  ```

  > æé†’ï¼šæ¯æ¬¡ä½¿ç”¨ ComfyUI å‰ï¼Œéƒ½éœ€è¦ activate è™›æ“¬ç’°å¢ƒã€‚è¦é€€å‡ºå‰‡ç”¨ `deactivate`ã€‚([ComfyUI Wiki][1])

#### 2. å®‰è£ Comfy CLI

åœ¨å•Ÿç”¨çš„è™›æ“¬ç’°å¢ƒä¸­ï¼ŒåŸ·è¡Œï¼š

```bash
pip install comfy-cli
```

å¦‚æœä½ å¸Œæœ›å•Ÿç”¨å‘½ä»¤åˆ—è‡ªå‹•è£œå…¨ï¼ˆautocompleteï¼‰ï¼Œå¯ä»¥é¸æ“‡ï¼š

````bash
comfy --install-completion
``` :contentReference[oaicite:8]{index=8}

#### 3. å®‰è£ ComfyUI

å®‰è£ ComfyUI éå¸¸ç°¡å–® â€” åªè¦ä¸€å€‹æŒ‡ä»¤ï¼š

```bash
comfy install
````

é€™æœƒï¼š

* ä¸‹è¼‰ä¸¦å®‰è£æœ€æ–°ç‰ˆ ComfyUI
* è‡ªå‹•å®‰è£ ComfyUI-Managerï¼ˆç¯€é»ç®¡ç†å·¥å…·ï¼‰
* å»ºç«‹åŸºæœ¬å°ˆæ¡ˆçµæ§‹ ([ComfyUI Wiki][1])

ä½ ä¹Ÿå¯ä»¥åŠ ä¸Šé¸é …ä¾†å®¢è£½å®‰è£ï¼š

````bash
# å®‰è£åˆ°é è¨­è·¯å¾‘ ~/comfy
comfy install

# å®‰è£åˆ°æŒ‡å®šç›®éŒ„
comfy --workspace=/path/to/your/workspace install

# åœ¨ç•¶å‰ç›®éŒ„å°å·²å­˜åœ¨çš„ ComfyUI åšæ“ä½œï¼ˆä¾‹å¦‚æ›´æ–°ï¼‰
comfy --here install

# å°æœ€è¿‘åŸ·è¡Œï¼å®‰è£çš„ ComfyUI åšæ“ä½œ
comfy --recent install

# åƒ…å®‰è£ ComfyUIï¼Œä¸å®‰è£ ComfyUI-Manager
comfy install --skip-manager
``` :contentReference[oaicite:10]{index=10}

ä½ å¯ä»¥ç”¨é€™äº›æŒ‡ä»¤ä¾†æª¢æŸ¥å·¥ä½œç©ºé–“ï¼ˆworkspaceï¼‰çš„ä½ç½®ï¼š

```bash
# æª¢æŸ¥é è¨­å·¥ä½œç©ºé–“
comfy which

# æª¢æŸ¥æŒ‡å®šé¸é …çš„å·¥ä½œç©ºé–“
comfy --recent which
comfy --here which
``` :contentReference[oaicite:11]{index=11}

#### 4. å®‰è£ GPU æ”¯æ´ï¼ˆè¦–ä½ çš„ç¡¬é«”è€Œå®šï¼‰

- **NVIDIA GPUï¼ˆCUDAï¼‰**  
  ```bash
  pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu124
````

è«‹æ ¹æ“šä½ çš„ CUDA ç‰ˆæœ¬é¸æ“‡åˆé©çš„ PyTorchã€‚([ComfyUI Wiki][2])

* **AMD GPUï¼ˆROCmï¼‰**

  ````bash
  pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/rocm6.0
  ``` :contentReference[oaicite:13]{index=13}

  ````
* **åƒ…ä½¿ç”¨ CPU**

  ````bash
  pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
  ``` :contentReference[oaicite:14]{index=14}
  ````

#### 5. å•Ÿå‹• ComfyUI

å®‰è£å®Œæˆå¾Œï¼Œå¯ä»¥é€éä»¥ä¸‹æŒ‡ä»¤å•Ÿå‹• ComfyUIï¼š

```bash
comfy launch
```

é è¨­æƒ…æ³ä¸‹ï¼ŒComfyUI å°‡åœ¨ `http://localhost:8188` é‹è¡Œã€‚([ComfyUI Wiki][1])

å¸¸ç”¨å•Ÿå‹•é¸é …ï¼š

````bash
# èƒŒæ™¯é‹è¡Œ
comfy launch --background

# æŒ‡å®šç›£è½åœ°å€èˆ‡åŸ è™Ÿ
comfy launch -- --listen 0.0.0.0 --port 8080

# ä½¿ç”¨ CPU æ¨¡å¼
comfy launch -- --cpu

# ä½ VRAM æ¨¡å¼
comfy launch -- --lowvram

# åœæ­¢èƒŒæ™¯ä¸­çš„ ComfyUI å¯¦ä¾‹
comfy stop
``` :contentReference[oaicite:16]{index=16}

---

## æ–¹æ³•äºŒï¼šå¾ ComfyUI åŸå§‹ç¢¼å®‰è£ï¼ˆæ‰‹å‹•ï¼‰

å¦‚æœä½ åå¥½å‚³çµ±æ‰‹å‹•æ–¹å¼ï¼Œå¯åƒè€ƒä»¥ä¸‹æµç¨‹ï¼š:contentReference[oaicite:17]{index=17}

### æ­¥é©Ÿ

1. **å…‹éš† ComfyUI å€‰åº«**  
   ```bash
   git clone https://github.com/comfyanonymous/ComfyUI.git
   cd ComfyUI
````

2. **å»ºç«‹è™›æ“¬ç’°å¢ƒä¸¦å•Ÿç”¨**

   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```

3. **å®‰è£ç›¸ä¾å¥—ä»¶**

   ```bash
   pip install -r requirements.txt
   ```

4. **å®‰è£ GPU æ”¯æ´**
   æ ¹æ“šä½ çš„ GPU é¡å‹ï¼Œå®‰è£å°æ‡‰ç‰ˆæœ¬çš„ PyTorch é¡ä¼¼å‰è¿°æ–¹æ³•ã€‚([ComfyUI Wiki][1])

5. **å•Ÿå‹• ComfyUI**

   ````bash
   python main.py
   ``` :contentReference[oaicite:19]{index=19}
   ````

---

## å®‰è£å¾Œï¼šä¸‹è¼‰ï¼ç®¡ç†æ¨¡å‹ï¼ˆcheckpointsï¼‰

å®‰è£å®Œ ComfyUI å¾Œï¼Œè‹¥è¦é€²è¡Œåœ–åƒç”Ÿæˆï¼Œé€šå¸¸éœ€è¦ä¸‹è¼‰ã€ŒåŸºç¤æ¨¡å‹ï¼ˆbase modelsï¼‰ã€ã€‚æœ‰å…©ç¨®æ–¹å¼ï¼š

* æ‰‹å‹•å¾æ¨¡å‹ä¾†æºï¼ˆä¾‹å¦‚ Hugging Faceï¼‰ä¸‹è¼‰æ¨¡å‹æª”æ¡ˆï¼Œç„¶å¾Œæ”¾åˆ° `models/checkpoints/` ç›®éŒ„ã€‚([ComfyUI Wiki][2])
* æˆ–ä½¿ç”¨ comfy-cli æŒ‡ä»¤ä¸‹è¼‰ï¼Œä¾‹å¦‚ï¼š

  ````bash
  comfy model download --url https://huggingface.co/â€¦/v1-5-pruned.safetensors --relative-path models/checkpoints
  ``` :contentReference[oaicite:22]{index=22}
  ````

---
[1]: https://comfyui-wiki.com/zh/install/install-comfyui/install-comfyui-on-linux?utm_source=chatgpt.com "Linux ç³»ç»Ÿå®‰è£… ComfyUI æ•™ç¨‹ | ComfyUI Wiki"
[2]: https://comfyui-wiki.com/en/install/install-comfyui/install-comfyui-on-linux?utm_source=chatgpt.com "ComfyUI Linux Installation Tutorial | ComfyUI Wiki"
[3]: https://docs.comfy.org/installation/desktop/linux?utm_source=chatgpt.com "Linux Desktop Version - ComfyUI"
